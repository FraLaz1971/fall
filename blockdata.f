C
      SUBROUTINE LOAD
        CHARACTER *80 IFNAM
        PRINT *,'TYPE FILE NAME FROM WICH READING CONTACTS'
        READ *,IFNAM
        CALL LDRECS(IFNAM)
        RETURN
      END   

      SUBROUTINE DUMP(OFNAM)
C RID: RECORD ID
C U: UNIT ON WICH DUMP
        INTEGER DBDIM,I,U
        PARAMETER(DBDIM=1024)
        INTEGER RID(DBDIM)
        CHARACTER *80 OFNAM
        CHARACTER*20 ENAME(DBDIM),SURNAM(DBDIM),PLACE(DBDIM),
     &PLNAM(DBDIM),PNUM(DBDIM),CITY(DBDIM),PROVIN(DBDIM),NATION(DBDIM),
     &CELLN(DBDIM),HOMEN(DBDIM)
        CHARACTER*32 EMAIL(DBDIM)
C PC: POSTCODE (CAP FOR ITALY)
        CHARACTER*5 PC(DBDIM)
        COMMON /CONTAC/RID,ENAME,SURNAM,PLACE,PLNAM,PNUM,PC,CITY,
     &PROVIN,NATION,CELLN,HOMEN,EMAIL
        IF (OFNAM.EQ.'STDOUT') THEN
            U=6
        ELSE
            U=11
            OPEN(U,FILE=OFNAM)
        END IF
        DO 10 I=1,6
          CALL DMPREC(U,I)
10      CONTINUE 
      IF(U.EQ.11) CLOSE(U)
      RETURN
      END
C
      BLOCK DATA
        INTEGER DBDIM
        PARAMETER(DBDIM=1024)
        INTEGER RID(DBDIM)
        CHARACTER*20 ENAME(DBDIM),SURNAM(DBDIM),PLACE(DBDIM),
     &PLNAM(DBDIM),PNUM(DBDIM),CITY(DBDIM),PROVIN(DBDIM),NATION(DBDIM),
     &CELLN(DBDIM),HOMEN(DBDIM)
        CHARACTER*32 EMAIL(DBDIM)
C PC: POSTCODE (CAP FOR ITALY)
        CHARACTER*5 PC(DBDIM)
        COMMON /CONTAC/RID,ENAME,SURNAM,PLACE,PLNAM,PNUM,PC,CITY,
     &PROVIN,NATION,CELLN,HOMEN,EMAIL
        DATA RID/1,2,3,4,5,6,1018*0/,ENAME/'Francesco','Lisa',
     &'Massimiliano','Alessandro','Alberto','Maria Elena',1018*' '/
     &,SURNAM/'Lazzarotto','Pattaro','Lazzarotto','Lazzarotto',
     &'Lazzarotto','Lazzarotto',1018*' '/,
     &PLACE/'via','via','via','via','via','via',1018*' '/,
     &PLNAM/'Agordat','Fani','R.Zandonai','Pianari','Monte Grappa',
     &'G. B. Vico',1018*' '/,PNUM/'15','16','77','23','27','11',1018*' '
     &/,CITY/'Padova','Due Carrare','Latina','Crosara di Marostica',
     &'Maser√†','Latina',1018*' '/,PC/'35138','35020','04100','36063',
     &'35020','04100',1018*' '/,PROVIN/'Padova','Padova','Latina',
     &'Vicenza','Padova','Latina',1018*' '/,NATION/'Italia','Italia',
     &'Italia','Italia','Italia','Italia',1018*' '/,CELLN/
     &'+393357126078','+393409285254','+393892971152','+393338286944',
     &'+393387971587','+393332476762',1018*' '/,HOMEN/' ',' ',
     &'+390773600028','+3904241520789',' ','+3907731995778',1018*' '/
     &,EMAIL/'fralaz1971@gmail.com','lisa.pattaro@gmail.com',' ',
     &'ale35138@gmail.com','allazza@tin.it','lazzamelena@gmail.com'
     &,1018*' '/
      END
C SHWREC: SHOWS RECORD N. TRID
      SUBROUTINE DMPREC(U,TRID)
        IMPLICIT NONE
        INTEGER DBDIM,U
        PARAMETER(DBDIM=1024)
        INTEGER TRID,RID(DBDIM)
        CHARACTER*20 ENAME(DBDIM),SURNAM(DBDIM),PLACE(DBDIM),
     &PLNAM(DBDIM),PNUM(DBDIM),CITY(DBDIM),PROVIN(DBDIM),NATION(DBDIM),
     &CELLN(DBDIM),HOMEN(DBDIM)
        CHARACTER*32 EMAIL(DBDIM)
C PC: POSTCODE (CAP FOR ITALY)
        CHARACTER*5 PC(DBDIM)
        COMMON /CONTAC/RID,ENAME,SURNAM,PLACE,PLNAM,PNUM,PC,CITY,
     &PROVIN,NATION,CELLN,HOMEN,EMAIL
        WRITE(U,100) RID(TRID),ENAME(TRID),SURNAM(TRID),PLACE(TRID),
     &PLNAM(TRID),PNUM(TRID),CITY(TRID),PROVIN(TRID),NATION(TRID),
     &CELLN(TRID),HOMEN(TRID),EMAIL(TRID)
100     FORMAT(I4,',',10(A20,','),A32)
        RETURN
      END
C LDRECS: LOAD RECORDS
      SUBROUTINE LDRECS(IFNAM)
        IMPLICIT NONE
        INTEGER DBDIM,I
        PARAMETER(DBDIM=1024)
        INTEGER RID(DBDIM)
        CHARACTER *80 IFNAM
        CHARACTER*20 ENAME(DBDIM),SURNAM(DBDIM),PLACE(DBDIM),
     &PLNAM(DBDIM),PNUM(DBDIM),CITY(DBDIM),PROVIN(DBDIM),NATION(DBDIM),
     &CELLN(DBDIM),HOMEN(DBDIM)
        CHARACTER*32 EMAIL(DBDIM)
C PC: POSTCODE (CAP FOR ITALY)
        CHARACTER*5 PC(DBDIM)
        COMMON /CONTAC/RID,ENAME,SURNAM,PLACE,PLNAM,PNUM,PC,CITY,
     &PROVIN,NATION,CELLN,HOMEN,EMAIL
        OPEN(11,FILE=IFNAM,ERR=9000)
        DO 10,I=1,DBDIM
        READ(11,100,ERR=9100,END=80) RID(I),ENAME(I),SURNAM(I),
     &PLACE(I),PLNAM(I),PNUM(I),CITY(I),PROVIN(I),
     &NATION(I),CELLN(I),HOMEN(I),EMAIL(I)
        WRITE(*,110) RID(I),ENAME(I),SURNAM(I),
     &PLACE(I),PLNAM(I),PNUM(I),CITY(I),PROVIN(I),
     &NATION(I),CELLN(I),HOMEN(I),EMAIL(I)
10      CONTINUE
80      PRINT *,'END OF FILE REACHED, READ ',I-1,' RECORDS'
        GOTO 9999
100     FORMAT(I4,1X,10(A20,1X),A32)
110     FORMAT(I4,',',10(A20,','),A32)
9000    PRINT *,'ERROR IN OPENING INPUT FILE ',IFNAM    
        GOTO 9999
9100    PRINT *,'ERROR IN READING RECORD ',I    
9999    RETURN
      END
